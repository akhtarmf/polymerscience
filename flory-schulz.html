<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Polymer Sciences: Flory-Schulz</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.bundle.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.js"></script>
    <script
        src="https://cdnjs.cloudflare.com/ajax/libs/chartjs-plugin-annotation/0.5.7/chartjs-plugin-annotation.js"></script>
    <script src="https://unpkg.com/mathjs/lib/browser/math.js"></script>
</head>

<body>

    <!-- Header -->

    <img src="https://static.wixstatic.com/media/c6776b_cfa98697877f47a58e56a8f9ea16737e~mv2.png"
        style="float:right; width:25%; height: 25%">

    <!-- Accept input for coefficient 'p' -->

    <style>
        fieldset {
            display: inline-block;
            font: 80% sans-serif;
            margin-left: 1px;
            margin-right: 1px;
            padding-top: 0.75em;
            padding-bottom: 0.75em;
            padding-left: 0.75em;
            padding-right: 0.75em;
            border: none;
        }

        input[type=number] {
            width: 100%;
            padding: 10px 10px;
            margin: 5px 0;
            box-sizing: border-box;
            border: 1px solid #7A003C;
        }
    </style>

    <form id="pValue" action="">
        <fieldset>
            <p>
                <label for="p">Extent of Reaction, (0.00 > <i>p</i> â‰¥ 1.00)</label>
                <input id="p" name="p" type="number" min="0.005" max="1" step="0.005" placeholder="0.900"
                    onkeydown="return false" value='0.900' />
            </p>
        </fieldset>
    </form>

    <!-- ChartJS 'Scatter'-->

    <canvas id="myChart" width="800" height="450"></canvas>

    <!-- Footer -->

    <img src="https://static.wixstatic.com/media/c6776b_fd904ab717354645a26026a817af931a~mv2.png"
        style="width:75%; height: 75%; padding-top: 25px;" />

    <!-- ChartJS 'Scatter' JavaScript -->

    <script type="text/javascript">

        var plotNew = new Chart(document.getElementById("myChart").getContext('2d'))
        plotNew.destroy();

        let dataPoints = [{
            x: 0.0,
            y: 0
        }, {
            x: 0.5,
            y: 0.005270463
        }, {
            x: 1.0,
            y: 0.01
        }, {
            x: 1.5,
            y: 0.014230249
        }, {
            x: 2.0,
            y: 0.018
        }, {
            x: 2.5,
            y: 0.021345374
        }, {
            x: 3.0,
            y: 0.0243
        }, {
            x: 3.5,
            y: 0.026895171
        }, {
            x: 4.0,
            y: 0.02916
        }, {
            x: 4.5,
            y: 0.031121556
        }, {
            x: 5.0,
            y: 0.032805
        }, {
            x: 5.5,
            y: 0.034233711
        }, {
            x: 6.0,
            y: 0.0354294
        }, {
            x: 6.5,
            y: 0.03641222
        }, {
            x: 7.0,
            y: 0.03720087
        }, {
            x: 7.5,
            y: 0.03781269
        }, {
            x: 8.0,
            y: 0.038263752
        }, {
            x: 8.5,
            y: 0.038568944
        }, {
            x: 9.0,
            y: 0.038742049
        }, {
            x: 9.5,
            y: 0.03879582
        }, {
            x: 10.0,
            y: 0.038742049
        }, {
            x: 10.5,
            y: 0.038591631
        }, {
            x: 11.0,
            y: 0.038354628
        }, {
            x: 11.5,
            y: 0.038040322
        }, {
            x: 12.0,
            y: 0.037657272
        }, {
            x: 12.5,
            y: 0.037213359
        }, {
            x: 13.0,
            y: 0.03671584
        }, {
            x: 13.5,
            y: 0.036171385
        }, {
            x: 14.0,
            y: 0.035586122
        }, {
            x: 14.5,
            y: 0.034965672
        }, {
            x: 15.0,
            y: 0.034315189
        }, {
            x: 15.5,
            y: 0.033639388
        }, {
            x: 16.0,
            y: 0.032942581
        }, {
            x: 16.5,
            y: 0.032228704
        }, {
            x: 17.0,
            y: 0.031501343
        }, {
            x: 17.5,
            y: 0.030763763
        }, {
            x: 18.0,
            y: 0.030018927
        }, {
            x: 18.5,
            y: 0.029269523
        }, {
            x: 19.0,
            y: 0.028517981
        }, {
            x: 19.5,
            y: 0.027766493
        }, {
            x: 20.0,
            y: 0.027017034
        }, {
            x: 25,
            y: 0.019941611
        }, {
            x: 30,
            y: 0.014130386
        }, {
            x: 35,
            y: 0.009734494
        }, {
            x: 40,
            y: 0.006569281
        }, {
            x: 45,
            y: 0.004363982
        }, {
            x: 50,
            y: 0.002863208
        }, {
            x: 60,
            y: 0.001198007
        }, {
            x: 70,
            y: 0.000487339
        }, {
            x: 80,
            y: 0.0001942
        }, {
            x: 90,
            y: 7.61773E-05
        }, {
            x: 100,
            y: 2.95127E-05
        }, {
            x: 110,
            y: 1.13195E-05
        }, {
            x: 120,
            y: 4.30566E-06
        }, {
            x: 130,
            y: 1.6264E-06
        }, {
            x: 140,
            y: 6.10713E-07
        }, {
            x: 150,
            y: 2.28152E-07
        }, {
            x: 160,
            y: 8.48553E-08
        }, {
            x: 170,
            y: 3.14364E-08
        }, {
            x: 180,
            y: 1.1606E-08
        }, {
            x: 190,
            y: 4.27157E-09
        }, {
            x: 200,
            y: 1.5678E-09
        }]

        $('#p').on("click", (event) => {
            if (event.which === 1) {
                event.preventDefault();
                const pValue = parseFloat(event.target.value);
                dataPoints = dataPoints.map(point => {
                    point.x = parseFloat(point.x);
                    const y = math.round((point.x * ((1 - pValue) ** 2) * (pValue ** (point.x - 1))), 5);

                    return {
                        x: point.x,
                        y: y
                    };
                });

                console.log(dataPoints);

                plot.destroy();
                plotNew.destroy();

                // Generated plot
                plotNew = new Chart(document.getElementById("myChart").getContext('2d'), {

                    type: 'scatter',
                    data: {
                        datasets: [{
                            label: 'Line',
                            data: dataPoints,
                            fill: true,
                            borderColor: "#000000",
                            borderWidth: 1,
                            pointRadius: 2,
                            tension: 0,
                            showLine: true
                        }]
                    },
                    options: {
                        tooltips: { enabled: true },
                        // hover: { mode: null },
                        animation: {
                            duration: 0
                        },
                        scales: {
                            yAxes: [{
                                scaleLabel: {
                                    display: true,
                                    labelString: 'n\u2093'
                                },
                                // ticks: {
                                //     min: 0,
                                //     max: 0.05
                                // }
                            }],
                            xAxes: [{
                                scaleLabel: {
                                    display: true,
                                    labelString: 'x'
                                },
                                ticks: {
                                    min: 0,
                                    max: 150
                                }
                            }]
                        },
                        legend: {
                            display: false
                        }
                    },
                });

            }
        })

        var plot = new Chart(document.getElementById("myChart").getContext('2d'), {

            type: 'scatter',
            data: {
                datasets: [{
                    label: 'Line',
                    data: dataPoints,
                    fill: true,
                    borderColor: "#000000",
                    borderWidth: 1,
                    pointRadius: 2,
                    tension: 0,
                    showLine: true
                }]
            },
            options: {
                tooltips: { enabled: true },
                // hover: { mode: null },
                animation: {
                    duration: 0
                },
                scales: {
                    yAxes: [{
                        scaleLabel: {
                            display: true,
                            labelString: 'n\u2093'
                        },
                        // ticks: {
                        //     min: 0,
                        //     max: 0.05
                        // }
                    }],
                    xAxes: [{
                        scaleLabel: {
                            display: true,
                            labelString: 'x'
                        },
                        ticks: {
                            min: 0,
                            max: 150
                        }
                    }]
                },
                legend: {
                    display: false
                }
            },
        });

    </script>

</body>

</html>
